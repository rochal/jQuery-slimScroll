(function($){$.fn.extend({slimScrollH:function(options){var defaults={width:"250px",height:"auto",size:"7px",color:"#000",position:"bottom",distance:"1px",start:"left",opacity:.4,alwaysVisible:false,disableFadeOut:false,railVisible:false,railColor:"#333",railOpacity:.2,railDraggable:true,railClass:"slimScrollRailH",barClass:"slimScrollBarH",wrapperClass:"slimScrollDiv",allowPageScroll:false,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"};var o=$.extend(defaults,options);this.each(function(){var isOverPanel,isOverBar,isDragg,queueHide,touchDif,barWidth,percentScroll,lastScroll,divS="<div></div>",divMask="<div></div>",minBarWidth=30,releaseScroll=false;var me=$(this);var isMask=me.width()>=o.width;if(me.parent().hasClass(o.wrapperClass)&&$.inArray(o.barClass,me.parent().children().map(function(i,el){return $(el).attr("class")}))>=0&&$.inArray(o.railClass,me.parent().children().map(function(i,el){return $(el).attr("class")}))>=0){var offset_horizontal=me.scrollLeft();bar=me.parent().find("."+o.barClass);rail=me.parent().find("."+o.railClass);getBarHeight();if($.isPlainObject(options)){if("width"in options){if(options.width=="auto"){me.parent().css("width","auto");me.css("width","auto");var width=me.parent().parent().width();me.parent().css("width",width);me.css("width",width)}else{me.css("width",o.width);me.parent().css("width",o.width)}}if("scrollTo"in options){offset_horizontal=parseInt(o.scrollTo)}else if("scrollBy"in options){offset_horizontal+=parseInt(o.scrollBy)}else if("destroy"in options){bar.remove();rail.remove();me.unwrap();return}scrollContent(offset_horizontal,false,true)}return}o.width=o.width=="auto"?me.parent().width():o.width;o.height=o.height=="auto"?me.parent().height():o.height;var wrapper=me.parent();if(!me.parent().hasClass(o.wrapperClass)){wrapper=$(divS).addClass(o.wrapperClass).css({position:"relative",overflow:"hidden",width:o.width,height:o.height});me.css({overflow:"hidden",width:o.width,height:o.height});me.wrap(wrapper)}var rail=$(divS).addClass(o.railClass).css({width:"100%",height:o.size,position:"absolute",left:0,display:o.alwaysVisible&&o.railVisible?"block":"none","border-radius":o.railBorderRadius,background:o.railColor,opacity:o.railOpacity,zIndex:90});var bar=$(divS).addClass(o.barClass).css({background:o.color,height:o.size,position:"absolute",cursor:o.opacity?"move":"normal",left:0,opacity:o.opacity,display:o.alwaysVisible?"block":"none","border-radius":o.borderRadius,BorderRadius:o.borderRadius,MozBorderRadius:o.borderRadius,WebkitBorderRadius:o.borderRadius,zIndex:99});var posCss=o.position=="top"?{top:o.distance}:{bottom:o.distance};rail.css(posCss);bar.css(posCss);me.parent().append(bar);me.parent().append(rail);if(isMask&&o.mask_left_url){var mask_left=$(divMask).addClass("mask_left").css({width:"20px",height:"100%",position:"absolute",top:0,left:0,display:bar.position().left<=0?"none":"block",backgroundImage:"url("+o.mask_left_url+")",backgroundRepeat:"y",zIndex:85});me.parent().append(mask_left)}if(isMask&&o.mask_right_url){var mask_right=$(divMask).addClass("mask_right").css({width:"20px",height:"100%",position:"absolute",bottom:0,right:0,display:bar.position().left>=me.width()-bar.width()?"none":"block",backgroundImage:"url("+o.mask_right_url+")",backgroundRepeat:"y",zIndex:85});me.parent().append(mask_right)}if(o.railDraggable){bar.bind("mousedown",function(e){var $doc=$(document);isDragg=true;t=parseFloat(bar.css("left"));pageY=e.pageX;$doc.bind("mousemove.slimscroll",function(e){currLeft=t+e.pageX-pageY;bar.css("left",currLeft);scrollContent(0,bar.position().left,false)});$doc.bind("mouseup.slimscroll",function(e){isDragg=false;hideBar();$doc.unbind(".slimscroll")});return false}).bind("selectstart.slimscroll",function(e){e.stopPropagation();e.preventDefault();return false})}rail.hover(function(){showBar()},function(){hideBar()});bar.hover(function(){isOverBar=true},function(){isOverBar=false});me.hover(function(){isOverPanel=true;showBar();hideBar()},function(){isOverPanel=false;hideBar()});me.bind("touchstart",function(e,b){if(e.originalEvent.touches.length){touchDif=e.originalEvent.touches[0].pageY}});me.bind("touchmove",function(e){if(!releaseScroll){e.originalEvent.preventDefault()}if(e.originalEvent.touches.length){var diff=(touchDif-e.originalEvent.touches[0].pageY)/o.touchScrollStep;scrollContent(diff,true);touchDif=e.originalEvent.touches[0].pageY}});getBarHeight();if(o.start==="right"){bar.css({left:me.outerWidth()-bar.outerWidth()});scrollContent(0,true)}else if(o.start!=="left"){scrollContent($(o.start).position().left,null,true);if(!o.alwaysVisible){bar.hide()}}attachWheel();function _onWheel(e){if(!isOverPanel){return}var e=e||window.event;var delta=0;if(e.wheelDelta){delta=-e.wheelDelta/120}if(e.detail){delta=e.detail/3}if(e.wheelDeltaX||e.deltaX||e.axis==1){var target=e.target||e.srcTarget||e.srcElement;if($(target).closest("."+o.wrapperClass).is(me.parent())){scrollContent(delta,true)}if(e.preventDefault&&!releaseScroll){e.preventDefault()}if(!releaseScroll){e.returnValue=false}}}function scrollContent(y,isWheel,isJump){releaseScroll=false;var delta=y;var maxLeft=me.outerWidth()-bar.outerWidth();if(isMask){me.parent().find(".mask_left").css({display:bar.position().left<=0?"none":"block"});me.parent().find(".mask_right").css({display:bar.position().left>=me.width()-bar.width()?"none":"block"})}if(isWheel){delta=parseInt(bar.css("left"))+y*parseInt(o.wheelStep)/100*bar.outerWidth();delta=Math.min(Math.max(delta,0),maxLeft);delta=y>0?Math.ceil(delta):Math.floor(delta);bar.css({left:delta+"px"})}percentScroll=parseInt(bar.css("left"))/(me.outerWidth()-bar.outerWidth());delta=percentScroll*(me[0].scrollWidth-me.outerWidth());if(isJump){delta=y;var offsetLeft=delta/me[0].scrollWidth*me.outerWidth();offsetLeft=Math.min(Math.max(offsetLeft,0),maxLeft);bar.css({left:offsetLeft+"px"})}me.scrollLeft(delta);me.trigger("slimscrolling",~~delta);showBar();hideBar()}function attachWheel(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",_onWheel,false);this.addEventListener("mousewheel",_onWheel,false);this.addEventListener("MozMousePixelScroll",_onWheel,false)}else{document.attachEvent("onmousewheel",_onWheel)}}function getBarHeight(){barWidth=Math.max(me.outerWidth()/me[0].scrollWidth*me.outerWidth(),minBarWidth);bar.css({width:barWidth+"px"});var display=barWidth==me.outerWidth()?"none":"block";bar.css({display:display})}function showBar(){getBarHeight();clearTimeout(queueHide);if(percentScroll==~~percentScroll){releaseScroll=o.allowPageScroll;if(lastScroll!=percentScroll){var msg=~~percentScroll==0?"left":"right";me.trigger("slimscroll",msg)}}else{releaseScroll=false}lastScroll=percentScroll;if(barWidth>=me.outerWidth()){releaseScroll=true;return}bar.stop(true,true).fadeIn("fast");if(o.railVisible){rail.stop(true,true).fadeIn("fast")}}function hideBar(){if(!o.alwaysVisible){queueHide=setTimeout(function(){if(!(o.disableFadeOut&&isOverPanel)&&!isOverBar&&!isDragg){bar.fadeOut("slow");rail.fadeOut("slow")}},1e3)}}});return this}});$.fn.extend({slimscrollH:$.fn.slimScrollH})})(jQuery);